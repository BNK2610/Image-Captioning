2024-12-07 02:08:37,650 INFO    MainThread:7300 [wandb_setup.py:_flush():68] Current SDK version is 0.19.0
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_setup.py:_flush():68] Configure stats pid to 7300
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_setup.py:_flush():68] Loading settings from C:\Users\Administrator\.config\wandb\settings
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_setup.py:_flush():68] Loading settings from C:\Image-Captioning\wandb\settings
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_setup.py:_flush():68] Loading settings from environment variables
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_init.py:_log_setup():528] Logging user logs to C:\Image-Captioning\logs\train\runs\2024-12-07_02-08-30\wandb\run-20241207_020837-m0e6m8gr\logs\debug.log
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_init.py:_log_setup():529] Logging internal logs to C:\Image-Captioning\logs\train\runs\2024-12-07_02-08-30\wandb\run-20241207_020837-m0e6m8gr\logs\debug-internal.log
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_init.py:init():639] calling init triggers
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_init.py:init():645] wandb.init called with sweep_config: {}
config: {}
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_init.py:init():688] starting backend
2024-12-07 02:08:37,651 INFO    MainThread:7300 [wandb_init.py:init():692] sending inform_init request
2024-12-07 02:08:37,664 INFO    MainThread:7300 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=spawn, using: spawn
2024-12-07 02:08:37,666 INFO    MainThread:7300 [wandb_init.py:init():705] backend started and connected
2024-12-07 02:08:37,666 INFO    MainThread:7300 [wandb_init.py:init():798] updated telemetry
2024-12-07 02:08:37,699 INFO    MainThread:7300 [wandb_init.py:init():830] communicating run to backend with 90.0 second timeout
2024-12-07 02:08:38,429 INFO    MainThread:7300 [wandb_init.py:init():882] starting run threads in backend
2024-12-07 02:08:38,714 INFO    MainThread:7300 [wandb_run.py:_console_start():2443] atexit reg
2024-12-07 02:08:38,715 INFO    MainThread:7300 [wandb_run.py:_redirect():2293] redirect: wrap_raw
2024-12-07 02:08:38,715 INFO    MainThread:7300 [wandb_run.py:_redirect():2358] Wrapping output streams.
2024-12-07 02:08:38,715 INFO    MainThread:7300 [wandb_run.py:_redirect():2383] Redirects installed.
2024-12-07 02:08:38,718 INFO    MainThread:7300 [wandb_init.py:init():925] run started, returning control to user process
2024-12-07 02:08:38,719 INFO    MainThread:7300 [wandb_run.py:_config_callback():1375] config_cb None None {'model': {'net': {'_target_': 'src.models.components.image_caption_net.ImageCaptionNet', 'image_embed_net': {'_target_': 'src.models.components.image_embedding.InceptionNet', 'drop_rate': 0.5, 'image_features': '${model.net.features}'}, 'text_embed_net': {'_target_': 'src.models.components.text_embedding.Transformer', 'num_tokens': 1741, 'dim_model': '${model.net.features}', 'num_heads': 8, 'num_encoder_layers': 6, 'num_decoder_layers': 6, 'dropout_p': 0.1}, 'features': 256, 'dataset_dir': '${model.dataset_dir}'}, '_target_': 'src.models.ImageCaptionModule', 'optimizer': {'_target_': 'torch.optim.Adam', '_partial_': True, 'lr': 0.0001, 'weight_decay': 0.0}, 'scheduler': {'_target_': 'torch.optim.lr_scheduler.ReduceLROnPlateau', '_partial_': True, 'mode': 'min', 'factor': 0.1, 'patience': 10}, 'dataset_dir': '${paths.data_dir}/${data.dataset_name}'}, 'model/params/total': 44407138, 'model/params/trainable': 19294874, 'model/params/non_trainable': 25112264, 'data': {'_target_': 'src.data.ImageCaptionDataModule', 'data_dir': '${paths.data_dir}', 'train_val_test_split': [0.8, 0.1, 0.1], 'batch_size': 2, 'num_workers': 10, 'pin_memory': True, 'dataset_name': 'flickr8k'}, 'trainer': {'_target_': 'lightning.pytorch.trainer.Trainer', 'default_root_dir': '${paths.output_dir}', 'min_epochs': 1, 'max_epochs': 30, 'accelerator': 'gpu', 'devices': 1, 'check_val_every_n_epoch': 1, 'deterministic': False}, 'callbacks': {'model_checkpoint': {'_target_': 'lightning.pytorch.callbacks.ModelCheckpoint', 'dirpath': '${paths.output_dir}/checkpoints', 'filename': 'epoch_{epoch:03d}', 'monitor': 'val/acc', 'verbose': False, 'save_last': True, 'save_top_k': 1, 'mode': 'max', 'auto_insert_metric_name': False, 'save_weights_only': False, 'every_n_train_steps': None, 'train_time_interval': None, 'every_n_epochs': None, 'save_on_train_epoch_end': None}, 'early_stopping': {'_target_': 'lightning.pytorch.callbacks.EarlyStopping', 'monitor': 'val/acc', 'min_delta': 0.0, 'patience': 100, 'verbose': False, 'mode': 'max', 'strict': True, 'check_finite': True, 'stopping_threshold': None, 'divergence_threshold': None, 'check_on_train_epoch_end': None}, 'model_summary': {'_target_': 'lightning.pytorch.callbacks.RichModelSummary', 'max_depth': -1}, 'rich_progress_bar': {'_target_': 'lightning.pytorch.callbacks.RichProgressBar'}}, 'extras': {'ignore_warnings': False, 'enforce_tags': True, 'print_config': True}, 'task_name': 'train', 'tags': ['dev'], 'ckpt_path': None, 'seed': 12345}
2024-12-07 02:26:39,544 WARNING MsgRouterThr:7300 [router.py:message_loop():75] message_loop has been closed
2024-12-07 02:27:44,852 INFO    MainThread:7300 [wandb_run.py:_finish():2169] finishing run lamai284/image_caption/m0e6m8gr
